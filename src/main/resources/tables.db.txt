CREATE TABLE users (
    id BIGINT PRIMARY KEY generated by default AS IDENTITY,
    username varchar(128) UNIQUE,
    firstname varchar(128),
    lastname varchar(128),
    birth_date date,
    role varchar(128),
    info JSONB,
    company_id INT REFERENCES company(id)
);

CREATE TABLE profile(
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    user_id BIGINT NOT NULL UNIQUE REFERENCES users(id),
    street varchar(128),
    language char(2)
);

CREATE TABLE company(
    id INT PRIMARY KEY generated BY DEFAULT AS IDENTITY,
    name varchar(64) NOT NULL UNIQUE
);

CREATE TABLE chat(
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    name varchar(64) NOT NULL UNIQUE
);

CREATE TABLE users_chat(
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    user_id BIGINT REFERENCES users(id),
    chat_id BIGINT REFERENCES chat(id),
    created_at timestamp NOT NULL,
    created_by varchar(128) NOT NULL,
    UNIQUE (user_id, chat_id)
);

create table company_locale(
    company_id INT NOT NULL REFERENCES company(id),
    language char(2) NOT NULL,
    description varchar(128) NOT NULL,
    PRIMARY KEY (company_id, language)
);

DROP TABLE users_chat;

DROP TABLE users;

DROP TABLE profile;